<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="refresh" content="7200" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>comercial-blutrafos - Power Portal</title>
    <link rel="shortcut icon" href="https://www.powerportal.com.br/img/favicon.png">
    <style>
        body {
            font-family: Verdana, sans-serif;
            height: 100%;
            background-color: #FFFFFF;
            margin: 0;
            padding: 0;
        }
        iframe {
            width: 100%;
            height: 100vh;
            border: none;
            display: none;
        }
        .active {
            display: block;
        }
        .loading-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: white;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>

<!-- Tela de carregamento enquanto as páginas estão sendo carregadas -->
<div id="loading-screen" class="loading-screen">Atualizando dados...</div>

<div class="slideshow-container">
    <!-- Páginas rápidas que não precisam ser recarregadas -->
    <iframe id="report-iframe-0" src="https://app.powerbi.com/view?r=eyJrIjoiY2U5OGVmZDItMjNiYy00ZThjLWIwNTktZjMwNzc5OGIwY2JkIiwidCI6IjZkOWMyYzg0LTRkMjQtNDc3MC04MWE5LTdjZjg0ZmEyNDMwZCJ9&pageName=ReportSectionb6f283363566eccd644e" class="active" allowFullScreen="true"></iframe>
    <iframe id="report-iframe-1" src="https://app.powerbi.com/view?r=eyJrIjoiY2U5OGVmZDItMjNiYy00ZThjLWIwNTktZjMwNzc5OGIwY2JkIiwidCI6IjZkOWMyYzg0LTRkMjQtNDc3MC04MWE5LTdjZjg0ZmEyNDMwZCJ9&pageName=ReportSection105c4019e48dc52a7222" allowFullScreen="true"></iframe>
    <iframe id="report-iframe-2" src="https://app.powerbi.com/view?r=eyJrIjoiY2U5OGVmZDItMjNiYy00ZThjLWIwNTktZjMwNzc5OGIwY2JkIiwidCI6IjZkOWMyYzg0LTRkMjQtNDc3MC04MWE5LTdjZjg0ZmEyNDMwZCJ9&pageName=ReportSection1dc50c032a19a26803b4" allowFullScreen="true"></iframe>

    <!-- iframe especial (matriz) que precisa ser recarregado -->
    <iframe id="report-iframe-dynamic" style="display: none;" allowFullScreen="true"></iframe>

    <!-- Páginas rápidas que não precisam ser recarregadas -->
    <iframe id="report-iframe-3" src="https://app.powerbi.com/view?r=eyJrIjoiY2U5OGVmZDItMjNiYy00ZThjLWIwNTktZjMwNzc5OGIwY2JkIiwidCI6IjZkOWMyYzg0LTRkMjQtNDc3MC04MWE5LTdjZjg0ZmEyNDMwZCJ9&pageName=ReportSection9af8bc684709045ab008" allowFullScreen="true"></iframe>
    <iframe id="report-iframe-4" src="https://app.powerbi.com/view?r=eyJrIjoiY2U5OGVmZDItMjNiYy00ZThjLWIwNTktZjMwNzc5OGIwY2JkIiwidCI6IjZkOWMyYzg0LTRkMjQtNDc3MC04MWE5LTdjZjg0ZmEyNDMwZCJ9&pageName=ReportSectiond7929aa355a09b01c060" allowFullScreen="true"></iframe>
</div>

<script>
    var slideIndex = 0;
    var dynamicLink = "https://app.powerbi.com/view?r=eyJrIjoiY2U5OGVmZDItMjNiYy00ZThjLWIwNTktZjMwNzc5OGIwY2JkIiwidCI6IjZkOWMyYzg0LTRkMjQtNDc3MC04MWE5LTdjZjg0ZmEyNDMwZCJ9&pageName=ReportSectione3cd9c1c09aa9410039d";
    var dynamicIframe = document.getElementById("report-iframe-dynamic");

    // Função para alternar entre os iframes pré-carregados (sem recarregar)
    function showSlides() {
        var iframes = document.querySelectorAll('iframe');
        
        // Ocultar todos os iframes
        iframes.forEach(function(iframe) {
            iframe.classList.remove('active');
        });

        // Controlar se estamos na página especial que precisa recarregar
        if (slideIndex === 3) {
            dynamicIframe.src = dynamicLink;
            dynamicIframe.classList.add('active');
            setTimeout(showSlides, 1000); // Exibição especial: 50 segundos
        } else {
            document.getElementById('report-iframe-' + (slideIndex < 3 ? slideIndex : slideIndex - 1)).classList.add('active');
            setTimeout(showSlides, 30000); // Troca rápida: 30 segundos
        }

        slideIndex = (slideIndex + 1) % 6;
    }

    // Função para ocultar a tela de carregamento quando os iframes rápidos carregarem
    function hideLoadingScreen() {
        var iframes = document.querySelectorAll('iframe:not(#report-iframe-dynamic)');
        var loadedCount = 0;

        // Monitorar quando todos os iframes forem carregados
        iframes.forEach(function(iframe) {
            iframe.onload = function() {
                loadedCount++;
                if (loadedCount === iframes.length) {
                    document.getElementById("loading-screen").style.display = "none"; // Esconder tela de carregamento
                    showSlides(); // Iniciar apresentação de slides
                }
            };
        });
    }

    // Pré-carregar o iframe especial e iniciar as verificações
    dynamicIframe.src = dynamicLink;
    dynamicIframe.onload = function() {
        console.log("Dynamic iframe carregado.");
    };

    hideLoadingScreen();
</script>

</body>
</html>
